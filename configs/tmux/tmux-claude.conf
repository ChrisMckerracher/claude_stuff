# ═══════════════════════════════════════════════════════════════════════════════
#   CLAUDE CODE TMUX THEME
#   A modern, minimal theme inspired by Anthropic's Claude
# ═══════════════════════════════════════════════════════════════════════════════

# ─── CORE SETTINGS ─────────────────────────────────────────────────────────────
set -g default-terminal "tmux-256color"
set -g allow-rename off          # Prevent programs from changing pane titles (for claude-bus)
set -ag terminal-overrides ",xterm-256color:RGB"
set -g mouse on
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g escape-time 0
set -g history-limit 50000
set -g focus-events on

# ─── CLAUDE COLOR PALETTE ──────────────────────────────────────────────────────
# Primary:    #D97757 (Claude Orange/Coral)
# Background: #1a1a1a (Deep Black)
# Surface:    #2d2d2d (Dark Gray)
# Border:     #404040 (Medium Gray)
# Accent:     #cc785c (Warm Orange)
# Text:       #e5e5e5 (Light Gray)
# Muted:      #808080 (Gray)

# ─── STATUS BAR ────────────────────────────────────────────────────────────────
set -g status on
set -g status-position bottom
set -g status-justify left
set -g status-interval 1

# Status bar colors
set -g status-style "bg=#1a1a1a,fg=#e5e5e5"
set -g status-left-length 100
set -g status-right-length 100

# Left: Claude icon pill + session pill
set -g status-left "#[fg=#D97757,bg=#1a1a1a]#[fg=#1a1a1a,bg=#D97757,bold] ✦ #[fg=#D97757,bg=#1a1a1a] #[fg=#2d2d2d,bg=#1a1a1a]#[fg=#e5e5e5,bg=#2d2d2d] #S #[fg=#2d2d2d,bg=#1a1a1a] "

# Right: time + date pill
set -g status-right "#[fg=#2d2d2d,bg=#1a1a1a]#[fg=#808080,bg=#2d2d2d] %H:%M │ %b %d #[fg=#2d2d2d,bg=#1a1a1a]"

# ─── WINDOW STATUS ─────────────────────────────────────────────────────────────
setw -g window-status-format "#[fg=#2d2d2d,bg=#1a1a1a]#[fg=#808080,bg=#2d2d2d] #I:#W #[fg=#2d2d2d,bg=#1a1a1a]"
setw -g window-status-current-format "#[fg=#D97757,bg=#1a1a1a]#[fg=#1a1a1a,bg=#D97757,bold] #I:#W #[fg=#D97757,bg=#1a1a1a]"
setw -g window-status-separator " "

# ─── PANE STYLING ──────────────────────────────────────────────────────────────
# Pane borders
set -g pane-border-style "fg=#404040"
set -g pane-active-border-style "fg=#D97757"

# Pane border lines (double lines for modern look)
set -g pane-border-lines double

# Display pane indicators
set -g display-panes-colour "#404040"
set -g display-panes-active-colour "#D97757"
set -g display-panes-time 2000

# ─── MESSAGE STYLING ───────────────────────────────────────────────────────────
set -g message-style "fg=#e5e5e5,bg=#2d2d2d"
set -g message-command-style "fg=#D97757,bg=#2d2d2d"

# ─── MODE/COPY STYLING ─────────────────────────────────────────────────────────
setw -g mode-style "fg=#1a1a1a,bg=#D97757"

# ─── CLOCK ─────────────────────────────────────────────────────────────────────
setw -g clock-mode-colour "#D97757"
setw -g clock-mode-style 24

# ─── KEY BINDINGS ──────────────────────────────────────────────────────────────
# Prefix (Ctrl+Space)
unbind C-b
set -g prefix C-Space
bind C-Space send-prefix

# Reload config
bind r source-file ~/.tmux-claude.conf \; display-message "Config reloaded"

# Split panes with | and -
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Vim-style pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# New window in current path
bind c new-window -c "#{pane_current_path}"

# ─── CLAUDE LAYOUT (nnn + 4 panes) ─────────────────────────────────────────────
# Creates the Claude Code layout: narrow nnn on left (~18%), 2x2 grid on right (~82%)

# Ctrl+Space C-d → prompts for directory, then creates layout there
bind C-d command-prompt -p "Directory:" "\
    new-window -c '%1' -n 'claude' ; \
    split-window -h -p 82 -c '%1' ; \
    split-window -h -p 50 -c '%1' ; \
    split-window -v -p 50 -c '%1' ; \
    select-pane -L ; \
    split-window -v -p 50 -c '%1' ; \
    select-pane -t 1 -T 'file-manager' ; \
    select-pane -t 2 -T 'orchestrator' ; \
    select-pane -t 3 -T 'file_viewer' ; \
    select-pane -t 4 -T 'z.ai2' ; \
    select-pane -t 5 -T 'z.ai1' ; \
    select-pane -t 1 ; \
    send-keys 'cd %1 && NNN_OPENER=~/.config/nnn/opener nnn' Enter"

# Ctrl+Space C-c → creates layout in current directory
bind C-c new-window -n "claude" \; \
    send-keys "NNN_OPENER=~/.config/nnn/opener nnn" Enter \; \
    split-window -h -p 82 \; \
    split-window -h -p 50 \; \
    split-window -v -p 50 \; \
    select-pane -L \; \
    split-window -v -p 50 \; \
    select-pane -t 1 -T "file-manager" \; \
    select-pane -t 2 -T "orchestrator" \; \
    select-pane -t 3 -T "file_viewer" \; \
    select-pane -t 4 -T "z.ai2" \; \
    select-pane -t 5 -T "z.ai1" \; \
    select-pane -t 1

# ─── AUTO-LAUNCH LAYOUT ON NEW SESSION ─────────────────────────────────────────
# Using relative pane navigation (-L = left) to avoid pane renumbering issues
# 1. split-window -h -p 82   → create right section (focus on right)
# 2. split-window -h -p 50   → split right into 2 columns (focus on rightmost)
# 3. split-window -v -p 50   → split rightmost column vertically
# 4. select-pane -L          → move left to middle column
# 5. split-window -v -p 50   → split middle column vertically
# 6. select-pane -t 0        → go back to nnn pane
set-hook -g session-created '\
    split-window -h -p 82 ; \
    split-window -h -p 50 ; \
    split-window -v -p 50 ; \
    select-pane -L ; \
    split-window -v -p 50 ; \
    select-pane -t 1 -T "file-manager" ; \
    select-pane -t 2 -T "orchestrator" ; \
    select-pane -t 3 -T "file_viewer" ; \
    select-pane -t 4 -T "z.ai2" ; \
    select-pane -t 5 -T "z.ai1" ; \
    select-pane -t 1 ; \
    send-keys "NNN_OPENER=~/.config/nnn/opener nnn" Enter'

# ═══════════════════════════════════════════════════════════════════════════════
